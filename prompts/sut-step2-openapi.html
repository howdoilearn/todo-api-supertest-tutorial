<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Supertest Tutorial - OpenAPI Specification</title>
    <style>
/* Structured Prompts Theme System */
:root {
  --primary-color: #1a73e8;
  --secondary-color: #34a853;
  --accent-color: #ff9800;
  --danger-color: #ea4335;
  --background-light: #f8f9fa;
  --text-dark: #333;
  --text-medium: #5f6368;
  --text-light: #9aa0a6;
  --border-light: #e8f0fe;
  --border-medium: #dadce0;
  --shadow-light: 0 2px 4px rgba(0,0,0,0.1);
  --shadow-medium: 0 4px 12px rgba(0,0,0,0.15);
  --shadow-strong: 0 6px 16px rgba(0,0,0,0.2);
  --radius-small: 8px;
  --radius-medium: 12px;
  --radius-large: 15px;
  --spacing-xs: 8px;
  --spacing-sm: 16px;
  --spacing-md: 24px;
  --spacing-lg: 32px;
  --spacing-xl: 48px;
}

/* Typography System */
.hero-title { font-size: 3.5em; color: var(--primary-color); font-weight: 700; text-align: center; margin-bottom: var(--spacing-md); line-height: 1.2; }
.section-title { font-size: 2.5em; color: var(--primary-color); font-weight: 600; text-align: center; margin: var(--spacing-xl) 0 var(--spacing-lg) 0; }
.card-title { font-size: 1.8em; color: var(--primary-color); font-weight: 600; margin-bottom: var(--spacing-sm); }
.body-large { font-size: 1.4em; line-height: 1.6; color: var(--text-dark); }
.body-medium { font-size: 1.3em; line-height: 1.6; color: var(--text-dark); }
.body-small { font-size: 1.1em; line-height: 1.5; color: var(--text-medium); }

/* Navigation */
.navbar { background: white; box-shadow: var(--shadow-light); padding: var(--spacing-md) 0; position: sticky; top: 0; z-index: 100; }
.nav-container { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; padding: 0 var(--spacing-md); }
.nav-logo { font-size: 1.8em; font-weight: 700; color: var(--primary-color); text-decoration: none; }
.nav-menu { display: flex; list-style: none; margin: 0; padding: 0; gap: var(--spacing-lg); }
.nav-item a { color: var(--text-dark); text-decoration: none; font-weight: 500; font-size: 1.2em; transition: color 0.3s ease; }
.nav-item a:hover { color: var(--primary-color); }

/* Layout Components */
.hero-section { background: var(--background-light); padding: var(--spacing-xl) var(--spacing-md); border-radius: var(--radius-large); text-align: center; margin-bottom: var(--spacing-xl); box-shadow: var(--shadow-light); }
.content-section { margin: var(--spacing-xl) 0; padding: 0 var(--spacing-md); }
.container { max-width: 1200px; margin: 0 auto; padding: 0 var(--spacing-md); }
.card-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: var(--spacing-lg); margin: var(--spacing-lg) 0; }
.card { background: white; border: 2px solid var(--border-light); border-radius: var(--radius-medium); padding: var(--spacing-lg); box-shadow: var(--shadow-medium); transition: transform 0.3s ease, box-shadow 0.3s ease; }
.card:hover { transform: translateY(-4px); box-shadow: var(--shadow-strong); }
.feature-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--spacing-md); margin: var(--spacing-lg) 0; }
.feature-card { background: white; padding: var(--spacing-md); border-radius: var(--radius-medium); border-left: 4px solid var(--primary-color); box-shadow: var(--shadow-light); }

/* Button System */
.btn { display: inline-block; padding: var(--spacing-lg) var(--spacing-xl); border-radius: var(--radius-medium); text-decoration: none; font-size: 1.6em; font-weight: 600; text-align: center; transition: all 0.3s ease; border: none; cursor: pointer; }
.btn-primary { background: var(--primary-color); color: white; box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3); }
.btn-primary:hover { background: #1557b0; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(26, 115, 232, 0.4); }
.btn-secondary { background: var(--secondary-color); color: white; box-shadow: 0 4px 12px rgba(52, 168, 83, 0.3); }
.btn-secondary:hover { background: #2e7d32; transform: translateY(-2px); box-shadow: 0 6px 16px rgba(52, 168, 83, 0.4); }

/* Info Boxes */
.info-box { background: #e6f3ff; border-left: 4px solid var(--primary-color); padding: var(--spacing-md); border-radius: var(--radius-small); margin: var(--spacing-md) 0; }
.warning-box { background: #fff3e0; border-left: 4px solid var(--accent-color); padding: var(--spacing-md); border-radius: var(--radius-small); margin: var(--spacing-md) 0; }
.success-box { background: #e8f5e8; border-left: 4px solid var(--secondary-color); padding: var(--spacing-md); border-radius: var(--radius-small); margin: var(--spacing-md) 0; }

/* Form Components */
.form-container { background: var(--background-light); border-radius: var(--radius-medium); overflow: hidden; border: 1px solid var(--border-medium); margin: var(--spacing-lg) 0; }
.form-section { border-bottom: 1px solid var(--border-medium); }
.form-section:last-child { border-bottom: none; }
.form-header { background: var(--primary-color); color: white; padding: var(--spacing-md) var(--spacing-lg); cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: 600; font-size: 1.3em; }
.form-header:hover { background: #1557b0; }
.form-content { padding: var(--spacing-lg); display: none; }
.form-content.active { display: block; }
.form-row { margin-bottom: var(--spacing-lg); }
.form-row label { display: block; font-weight: 600; margin-bottom: var(--spacing-sm); color: var(--text-dark); font-size: 1.2em; }
.form-row select, .form-row textarea, .form-row input { width: 100%; padding: var(--spacing-md); border: 1px solid var(--border-medium); border-radius: var(--radius-small); font-size: 1.1em; font-family: inherit; }
.form-row textarea { min-height: 120px; resize: vertical; }
.form-help { font-size: 1em; color: var(--text-medium); margin-top: var(--spacing-sm); }

/* Responsive Design */
@media (max-width: 768px) {
  .hero-title { font-size: 2.5em; }
  .section-title { font-size: 2em; }
  .body-large { font-size: 1.2em; }
  .body-medium { font-size: 1.1em; }
  .nav-menu { flex-direction: column; gap: var(--spacing-sm); }
  .nav-container { flex-direction: column; gap: var(--spacing-md); }
}

@media (max-width: 480px) {
  .hero-title { font-size: 2em; }
  .hero-section { padding: var(--spacing-lg) var(--spacing-sm); }
  .content-section { padding: 0 var(--spacing-sm); }
}
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="nav-logo">üß™ Supertest Tutorial</a>
            <ul class="nav-menu">
                <li class="nav-item"><a href="sut-step1-setup.html">Step 1: Setup</a></li>
                <li class="nav-item"><a href="sut-step2-openapi.html">Step 2: OpenAPI</a></li>
                <li class="nav-item"><a href="#implementation">Step 3+</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <h1 class="hero-title">üìê Step 2: OpenAPI Specification</h1>
            <p class="body-large">Generate complete API contract with quality-first design principles</p>
            
            <div class="info-box" style="max-width: 800px; margin: var(--spacing-lg) auto;">
                <strong>üéØ Goal:</strong> Create a comprehensive OpenAPI 3.x specification that serves as the contract for implementation, includes quality attributes (testability, validation, error handling), and enables contract testing with Supertest.
            </div>
        </div>

        <!-- What You'll Get -->
        <div class="content-section">
            <h2 class="section-title">üìÅ What This Prompt Creates</h2>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <h3 style="color: var(--primary-color); margin-bottom: var(--spacing-sm);">üìÑ Complete OpenAPI Spec</h3>
                    <p class="body-medium">All endpoints, schemas, and security definitions in docs/openapi.yaml</p>
                </div>
                <div class="feature-card">
                    <h3 style="color: var(--primary-color); margin-bottom: var(--spacing-sm);">‚úÖ Quality Attributes</h3>
                    <p class="body-medium">Validation rules, error responses, and testability patterns embedded</p>
                </div>
                <div class="feature-card">
                    <h3 style="color: var(--primary-color); margin-bottom: var(--spacing-sm);">üîê Security Schemes</h3>
                    <p class="body-medium">JWT authentication patterns and authorization rules documented</p>
                </div>
                <div class="feature-card">
                    <h3 style="color: var(--primary-color); margin-bottom: var(--spacing-sm);">üìù Updated Session Notes</h3>
                    <p class="body-medium">Progress tracking with completed tasks and next steps</p>
                </div>
            </div>
        </div>

        <!-- Customization Form -->
        <div class="content-section">
            <h2 class="section-title">üõ†Ô∏è Customize Your OpenAPI Spec</h2>
            
            <div class="form-container">
                <!-- Section 1: Context -->
                <div class="form-section">
                    <div class="form-header" onclick="toggleSection(this)">
                        <span>1. Project Context</span>
                        <span>‚ñ≤</span>
                    </div>
                    <div class="form-content active">
                        <div class="form-row">
                            <label for="project-name">Project Name:</label>
                            <input type="text" id="project-name" value="todo-api-supertest-tutorial">
                            <div class="form-help">Must match Step 1 project name</div>
                        </div>
                        <div class="form-row">
                            <label for="api-title">API Title:</label>
                            <input type="text" id="api-title" value="Todo API">
                            <div class="form-help">Human-readable API name</div>
                        </div>
                        <div class="form-row">
                            <label for="api-description">API Description:</label>
                            <textarea id="api-description">A simple Todo API with user authentication and CRUD operations for task management. Built with quality-first design principles for comprehensive Supertest integration testing.</textarea>
                            <div class="form-help">Brief description of the API purpose</div>
                        </div>
                    </div>
                </div>

                <!-- Section 2: Quality Focus -->
                <div class="form-section">
                    <div class="form-header" onclick="toggleSection(this)">
                        <span>2. Quality-First Attributes</span>
                        <span>‚ñº</span>
                    </div>
                    <div class="form-content">
                        <div class="form-row">
                            <label for="validation-style">Validation Style:</label>
                            <select id="validation-style">
                                <option value="strict" selected>Strict (fail on extra fields)</option>
                                <option value="permissive">Permissive (allow extra fields)</option>
                            </select>
                            <div class="form-help">How strictly to validate request bodies</div>
                        </div>
                        <div class="form-row">
                            <label for="error-detail">Error Response Detail:</label>
                            <select id="error-detail">
                                <option value="detailed" selected>Detailed (field-level errors)</option>
                                <option value="simple">Simple (message only)</option>
                            </select>
                            <div class="form-help">Level of detail in error responses</div>
                        </div>
                        <div class="form-row">
                            <label for="examples">Include Examples:</label>
                            <select id="examples">
                                <option value="yes" selected>Yes (request/response examples)</option>
                                <option value="no">No (schemas only)</option>
                            </select>
                            <div class="form-help">Whether to include example payloads</div>
                        </div>
                    </div>
                </div>

                <!-- Section 3: Technical Details -->
                <div class="form-section">
                    <div class="form-header" onclick="toggleSection(this)">
                        <span>3. Technical Configuration</span>
                        <span>‚ñº</span>
                    </div>
                    <div class="form-content">
                        <div class="form-row">
                            <label for="server-url">Development Server URL:</label>
                            <input type="text" id="server-url" value="http://localhost:3000">
                            <div class="form-help">Local development server address</div>
                        </div>
                        <div class="form-row">
                            <label for="api-version">API Version:</label>
                            <input type="text" id="api-version" value="1.0.0">
                            <div class="form-help">Semantic version for the API</div>
                        </div>
                        <div class="form-row">
                            <label for="additional-notes">Additional Specification Notes:</label>
                            <textarea id="additional-notes" placeholder="Any special requirements, constraints, or design decisions..."></textarea>
                            <div class="form-help">Optional context for the specification</div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin: var(--spacing-xl) 0;">
                    <button class="btn btn-secondary" onclick="resetForm()" style="margin-right: var(--spacing-md); font-size: 1.2em; padding: var(--spacing-sm) var(--spacing-md);">üîÑ Reset</button>
                    <button class="btn btn-primary" onclick="generatePrompt()" style="font-size: 1.2em; padding: var(--spacing-sm) var(--spacing-md);">üìê Generate OpenAPI Prompt</button>
                </div>
            </div>
        </div>

        <!-- Quality First Concept -->
        <div class="content-section">
            <h2 class="section-title">‚ú® Quality-First Design Approach</h2>
            
            <div class="success-box">
                <h3 style="color: var(--secondary-color); margin-bottom: var(--spacing-md);">What Makes This Different</h3>
                <p class="body-medium">
                    Traditional API specs document what the API does. Quality-first specs document what the API does AND how to build it correctly. This OpenAPI specification embeds:
                </p>
                <ul style="margin-top: var(--spacing-md);">
                    <li class="body-medium"><strong>Testability:</strong> Clear request/response contracts for automated testing</li>
                    <li class="body-medium"><strong>Validation:</strong> Explicit rules that prevent bad data at API boundaries</li>
                    <li class="body-medium"><strong>Error Handling:</strong> Comprehensive error scenarios with specific status codes</li>
                    <li class="body-medium"><strong>Security:</strong> Authentication requirements and authorization rules documented</li>
                </ul>
                <p class="body-medium" style="margin-top: var(--spacing-md);">
                    When implementation follows this spec, code is defensive by default - and Supertest tests verify it stays that way.
                </p>
            </div>
        </div>

        <!-- Next Steps -->
        <div class="content-section">
            <h2 class="section-title">üöÄ What's Next?</h2>
            
            <div class="info-box">
                <strong>After OpenAPI Specification:</strong>
                <br><br>
                <strong>Step 3:</strong> Database Schema & Models ‚Üí
                <br>
                <strong>Step 4:</strong> Express App Implementation ‚Üí
                <br>
                <strong>Step 5:</strong> Supertest Test Suite
            </div>
        </div>
    </div>

    <script>
        function toggleSection(header) {
            const content = header.nextElementSibling;
            const arrow = header.querySelector('span:last-child');
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                arrow.textContent = '‚ñº';
            } else {
                content.classList.add('active');
                arrow.textContent = '‚ñ≤';
            }
        }

        function resetForm() {
            document.getElementById('project-name').value = 'todo-api-supertest-tutorial';
            document.getElementById('api-title').value = 'Todo API';
            document.getElementById('api-description').value = 'A simple Todo API with user authentication and CRUD operations for task management. Built with quality-first design principles for comprehensive Supertest integration testing.';
            document.getElementById('validation-style').value = 'strict';
            document.getElementById('error-detail').value = 'detailed';
            document.getElementById('examples').value = 'yes';
            document.getElementById('server-url').value = 'http://localhost:3000';
            document.getElementById('api-version').value = '1.0.0';
            document.getElementById('additional-notes').value = '';
        }

        function generatePrompt() {
            const projectName = document.getElementById('project-name').value;
            const apiTitle = document.getElementById('api-title').value;
            const apiDescription = document.getElementById('api-description').value;
            const validationStyle = document.getElementById('validation-style').value;
            const errorDetail = document.getElementById('error-detail').value;
            const includeExamples = document.getElementById('examples').value;
            const serverUrl = document.getElementById('server-url').value;
            const apiVersion = document.getElementById('api-version').value;
            const additionalNotes = document.getElementById('additional-notes').value;

            const promptText = `# Supertest Tutorial: OpenAPI Specification

## Role
You are an API architect specializing in quality-first design and contract-driven development. You create OpenAPI specifications that embed testability, validation, and defensive programming patterns.

## Mission
Generate a complete OpenAPI 3.x specification for the Todo API that serves as both documentation and implementation contract. This spec will guide code generation in Step 3 and enable contract testing with Supertest.

## Context from Step 1
Read the following file to understand requirements:
- \`/Users/testuser/git/${projectName}/docs/REQUIREMENTS.md\`

Extract from this file:
- All API endpoints and their details
- Data models and validation rules
- Authentication and authorization requirements
- Error handling specifications

## Project Details
- **API Title**: ${apiTitle}
- **API Description**: ${apiDescription}
- **Version**: ${apiVersion}
- **Server URL**: ${serverUrl}
- **Validation Style**: ${validationStyle}
- **Error Detail Level**: ${errorDetail}
- **Include Examples**: ${includeExamples}
${additionalNotes ? '- **Additional Notes**: ' + additionalNotes : ''}

## Quality-First Design Principles

This specification must embed these quality attributes:

### 1. Testability
- **Clear Contracts**: Every endpoint has explicit request/response schemas
- **Deterministic Responses**: Same input always produces same output structure
- **Error Scenarios**: All failure modes documented with specific status codes
- **Example Payloads**: ${includeExamples === 'yes' ? 'Include realistic examples for testing' : 'Schema definitions sufficient for testing'}

### 2. Validation
- **Input Validation**: All request schemas define required fields, types, formats, and constraints
- **Boundary Conditions**: Min/max lengths, value ranges, pattern matching where applicable
- **${validationStyle === 'strict' ? 'Strict Mode' : 'Permissive Mode'}**: ${validationStyle === 'strict' ? 'Reject requests with extra fields (additionalProperties: false)' : 'Allow extra fields in requests'}
- **Fail Fast**: Validation errors return immediately with clear field-level feedback

### 3. Error Handling
- **Consistent Format**: All errors follow standard structure
- **Specific Codes**: Use appropriate HTTP status codes (400, 401, 403, 404, 409, 500)
- **${errorDetail === 'detailed' ? 'Detailed Errors' : 'Simple Errors'}**: ${errorDetail === 'detailed' ? 'Include field-level validation errors with specific messages' : 'Return high-level error messages only'}
- **Security**: Never leak sensitive information in error responses

### 4. Security
- **Auth Requirements**: Clearly mark which endpoints require authentication
- **Authorization Rules**: Document ownership and permission constraints
- **Secure Patterns**: JWT tokens, password hashing requirements
- **Input Sanitization**: Prevent injection attacks through validation

## Required OpenAPI Specification

Create \`/Users/testuser/git/${projectName}/docs/openapi.yaml\` with this structure:

### Metadata Section
\`\`\`yaml
openapi: 3.0.0
info:
  title: ${apiTitle}
  version: ${apiVersion}
  description: ${apiDescription}
  contact:
    name: API Support
servers:
  - url: ${serverUrl}
    description: Development server
  - url: http://localhost:3000
    description: Local development
\`\`\`

### Security Schemes
\`\`\`yaml
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained from /api/auth/login or /api/auth/register
\`\`\`

### All Endpoints
For EACH endpoint from REQUIREMENTS.md, create complete path specification:

**Authentication Endpoints:**
- POST /api/auth/register
- POST /api/auth/login

**Todo Endpoints (all require JWT):**
- POST /api/todos
- GET /api/todos
- GET /api/todos/{id}
- PUT /api/todos/{id}
- DELETE /api/todos/{id}

### Schema Definitions
Create complete schemas in \`components/schemas\` for:

**User Schema:**
\`\`\`yaml
User:
  type: object
  required:
    - id
    - email
    - name
    - createdAt
  properties:
    id:
      type: integer
      example: 1
    email:
      type: string
      format: email
      example: user@example.com
    name:
      type: string
      minLength: 2
      maxLength: 50
      example: John Doe
    createdAt:
      type: string
      format: date-time
      example: 2025-01-01T00:00:00.000Z
    updatedAt:
      type: string
      format: date-time
      example: 2025-01-01T00:00:00.000Z
  ${validationStyle === 'strict' ? 'additionalProperties: false' : ''}
\`\`\`

**Todo Schema:**
\`\`\`yaml
Todo:
  type: object
  required:
    - id
    - userId
    - title
    - completed
    - createdAt
  properties:
    id:
      type: integer
      example: 1
    userId:
      type: integer
      example: 1
    title:
      type: string
      minLength: 1
      maxLength: 200
      example: Buy groceries
    description:
      type: string
      maxLength: 1000
      nullable: true
      example: Milk, eggs, bread
    completed:
      type: boolean
      default: false
      example: false
    dueDate:
      type: string
      format: date-time
      nullable: true
      example: 2025-12-31T23:59:59.000Z
    createdAt:
      type: string
      format: date-time
      example: 2025-01-01T00:00:00.000Z
    updatedAt:
      type: string
      format: date-time
      example: 2025-01-01T00:00:00.000Z
  ${validationStyle === 'strict' ? 'additionalProperties: false' : ''}
\`\`\`

**Error Response Schema:**
\`\`\`yaml
Error:
  type: object
  required:
    - error
  properties:
    error:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          example: Validation failed
        code:
          type: string
          example: VALIDATION_ERROR
        ${errorDetail === 'detailed' ? `details:
          type: array
          items:
            type: object
            required:
              - field
              - message
            properties:
              field:
                type: string
                example: email
              message:
                type: string
                example: Email is required` : ''}
\`\`\`

### Complete Path Specifications

For each endpoint, provide:

1. **Summary and description**
2. **Security requirements** (if protected)
3. **Request parameters** (path, query, body)
4. **All response codes** with schemas:
   - Success responses (200, 201, 204)
   - Client errors (400, 401, 403, 404, 409)
   - Server errors (500)
5. ${includeExamples === 'yes' ? '**Example requests and responses**' : ''}

**Example Structure:**
\`\`\`yaml
paths:
  /api/auth/register:
    post:
      summary: Register a new user
      description: Creates a new user account with email and password. Returns user object and JWT token for immediate authentication.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
                - name
              properties:
                email:
                  type: string
                  format: email
                  example: user@example.com
                password:
                  type: string
                  minLength: 8
                  example: securePassword123
                name:
                  type: string
                  minLength: 2
                  maxLength: 50
                  example: John Doe
              ${validationStyle === 'strict' ? 'additionalProperties: false' : ''}
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - user
                  - token
                properties:
                  user:
                    $ref: '#/components/schemas/User'
                  token:
                    type: string
                    example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
        '400':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '409':
          description: Email already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
\`\`\`

[Continue this pattern for ALL endpoints]

## Implementation Guidance in Specification

Add \`x-quality-attributes\` extension to document implementation requirements:

\`\`\`yaml
x-quality-attributes:
  testability:
    - All endpoints must be testable via Supertest without mocking
    - Responses must be deterministic for same inputs
    - Error scenarios must be reproducible
  validation:
    - Validate all inputs at route level before processing
    - Use schema validation library (Joi, Zod, or express-validator)
    - Return 400 with field-level errors for validation failures
  errorHandling:
    - Wrap all async operations in try-catch
    - Use centralized error handling middleware
    - Never expose stack traces in responses
    - Log errors server-side with context
  security:
    - Hash passwords with bcrypt before storage
    - Validate JWT on all protected routes
    - Prevent SQL injection through parameterized queries
    - Sanitize all user inputs
\`\`\`

## Update Session Notes

After creating the OpenAPI specification, update \`/Users/testuser/git/${projectName}/docs/SESSION_NOTES.md\`:

1. Mark Session 1 OpenAPI task as complete: \`- ‚úÖ Created OpenAPI specification stub\` ‚Üí \`- ‚úÖ Created complete OpenAPI specification\`
2. Update "In Progress" section if needed
3. Update "Next Session" with Step 3 tasks
4. Add notes about any design decisions made

## Quality Checks

Before completing, verify the OpenAPI specification:
- ‚úÖ All endpoints from REQUIREMENTS.md are included
- ‚úÖ Every endpoint has complete request/response documentation
- ‚úÖ All schemas are fully defined with validation constraints
- ‚úÖ Security requirements are clearly marked
- ‚úÖ Error responses cover all failure scenarios
- ‚úÖ ${includeExamples === 'yes' ? 'Examples are realistic and helpful' : 'Schemas are clear without examples'}
- ‚úÖ Quality attributes are embedded throughout
- ‚úÖ Specification is valid OpenAPI 3.0 format

## Completion Confirmation

After creating the specification, provide:
1. Confirmation that openapi.yaml was created
2. Summary of endpoints documented
3. List of schemas defined
4. Any design decisions or trade-offs made
5. Validation that file is valid OpenAPI 3.0

Generate a complete, production-ready OpenAPI specification that serves as the definitive contract for implementation and testing.`;

            showModal('üìê Supertest Tutorial - OpenAPI Specification Prompt', promptText);
        }

        function showModal(title, content) {
            const modalOverlay = document.createElement('div');
            modalOverlay.style.cssText = \`
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0, 0, 0, 0.7); z-index: 10000; display: flex;
                justify-content: center; align-items: center; padding: 20px;
            \`;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = \`
                background: white; border-radius: var(--radius-medium); width: 90%;
                max-width: 900px; max-height: 90%; overflow: hidden;
                box-shadow: var(--shadow-strong); display: flex; flex-direction: column;
            \`;
            
            const modalHeader = document.createElement('div');
            modalHeader.style.cssText = \`
                background: var(--primary-color); color: white;
                padding: var(--spacing-md) var(--spacing-lg);
                display: flex; justify-content: space-between; align-items: center;
            \`;
            
            const modalTitle = document.createElement('h3');
            modalTitle.textContent = title;
            modalTitle.style.cssText = \`margin: 0; font-size: 1.4em; font-weight: 600;\`;
            
            const closeButton = document.createElement('button');
            closeButton.innerHTML = '‚úï';
            closeButton.style.cssText = \`
                background: none; border: none; color: white; font-size: 1.5em;
                cursor: pointer; padding: 5px; width: 30px; height: 30px;
                border-radius: 50%; display: flex; align-items: center; justify-content: center;
            \`;
            closeButton.onmouseover = () => closeButton.style.background = 'rgba(255,255,255,0.2)';
            closeButton.onmouseout = () => closeButton.style.background = 'none';
            closeButton.onclick = () => document.body.removeChild(modalOverlay);
            
            modalHeader.appendChild(modalTitle);
            modalHeader.appendChild(closeButton);
            
            const modalBody = document.createElement('div');
            modalBody.style.cssText = \`padding: var(--spacing-lg); overflow-y: auto; flex: 1;\`;
            
            const promptTextArea = document.createElement('textarea');
            promptTextArea.value = content;
            promptTextArea.style.cssText = \`
                width: 100%; height: 400px; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
                font-size: 0.9em; line-height: 1.4; border: 1px solid var(--border-medium);
                border-radius: var(--radius-small); padding: var(--spacing-md);
                resize: vertical; background: #f8f9fa;
            \`;
            
            modalBody.appendChild(promptTextArea);
            
            const modalFooter = document.createElement('div');
            modalFooter.style.cssText = \`
                padding: var(--spacing-md) var(--spacing-lg);
                border-top: 1px solid var(--border-medium);
                display: flex; gap: var(--spacing-md); justify-content: flex-end;
            \`;
            
            const copyButton = document.createElement('button');
            copyButton.textContent = 'üìã Copy';
            copyButton.className = 'btn btn-secondary';
            copyButton.style.fontSize = '1em';
            copyButton.style.padding = '12px 24px';
            copyButton.onclick = () => {
                promptTextArea.select();
                document.execCommand('copy');
                copyButton.textContent = '‚úÖ Copied!';
                setTimeout(() => copyButton.textContent = 'üìã Copy', 2000);
            };
            
            const downloadButton = document.createElement('button');
            downloadButton.textContent = 'üíæ Download';
            downloadButton.className = 'btn btn-primary';
            downloadButton.style.fontSize = '1em';
            downloadButton.style.padding = '12px 24px';
            downloadButton.onclick = () => {
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'supertest-openapi-prompt.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };
            
            modalFooter.appendChild(copyButton);
            modalFooter.appendChild(downloadButton);
            
            modalContent.appendChild(modalHeader);
            modalContent.appendChild(modalBody);
            modalContent.appendChild(modalFooter);
            modalOverlay.appendChild(modalContent);
            
            modalOverlay.onclick = (e) => {
                if (e.target === modalOverlay) {
                    document.body.removeChild(modalOverlay);
                }
            };
            
            document.body.appendChild(modalOverlay);
            promptTextArea.focus();
        }
    </script>
</body>
</html>